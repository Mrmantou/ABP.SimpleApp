#### 创建People展示页面

到目前为止Person实体中只包含了Name一个描述属性，这里先给Person实体添加几个属性：
```csharp
[Table("AppPersons")]
public class Person : AuditedEntity<Guid>
{
    [Required]
    [StringLength(SimpleTaskAppConsts.MaxNameLength)]
    public string Name { get; set; }

    [StringLength(SimpleTaskAppConsts.MaxPhoneNumberLength)]
    public string PhoneNumber { get; set; }

    public int? Age { get; set; }

    public char? Gender { get; set; }

    [EmailAddress]
    public string Email { get; set; }

    [StringLength(SimpleTaskAppConsts.MaxAddressLength)]
    public string Address { get; set; }

    public Person() { }

    public Person(string name)
    {
        Name = name;
    }
}
```
接下来迁移变化到数据库：
```
PM> add-migration "add_Person_proterty"
To undo this action, use Remove-Migration.
PM> update-database
```
查看数据库可以看到数据库添加了新的字段：

![Databaseresult2](../image/databaseresult2.png)

#### 应用层查询所有的People信息

在应用服务层中`PersonAppService`中添加查询所有peoson信息的接口及方法：
```csharp
public interface IPersonAppService
{
    //...
    Task<ListResultDto<PersonListDto>> GetAl(GetAllPeopleInput input);
}

public class PersonAppService : SimpleTaskAppAppServiceBase, IPersonAppService
{
    //...
    public async Task<ListResultDto<PersonListDto>> GetAll(GetAllPeopleInput input)
    {
        var people = await repository.GetAll()
              .WhereIf(!string.IsNullOrEmpty(input.Name), p => p.Name == input.Name)
              .OrderBy(p => p.Name)
              .ToListAsync();

        return new ListResultDto<PersonListDto>(ObjectMapper.Map<List<PersonListDto>>(people));
    }
}
```
其中的入参和返回参数分别为：
```csharp
public class GetAllPeopleInput
{
    public string Name { get; set; }
}

[AutoMapFrom(typeof(Person))]
public class PersonListDto
{
    public string Name { get; set; }

    public string PhoneNumber { get; set; }

    public int? Age { get; set; }

    public char? Gender { get; set; }

    public string Email { get; set; }

    public string Address { get; set; }
}
```

#### 测试上面的查询方法
在.Tests项目中添加PeopleAppService的测试类，并添加两个方法从数据库中查询数据：
```csharp
public class PeopleAppService_Tests : SimpleTaskAppTestBase
{
    private readonly IPersonAppService personAppService;

    public PeopleAppService_Tests()
    {
        personAppService = Resolve<IPersonAppService>();
    }

    [Fact]
    public async Task Should_Get_All_People()
    {
        var output = await personAppService.GetAll(new GetAllPeopleInput());

        output.Items.Count.ShouldBe(2);
    }

    [Fact]
    public async Task Should_Get_Filtered_People()
    {
        var output = await personAppService.GetAll(new GetAllPeopleInput() { Name="Athy" });

        output.Items.Count.ShouldBe(1);
        output.Items.ShouldAllBe(p => p.Name == "Athy");
    }
}
```
这里为了测试效果在初始数据中又添加了一条person数据Athy：
```csharp
public void Build()
{
    //create test data here...
    var neo = new Person("Neo");
    var athy = new Person("Athy");
    _context.People.Add(neo);
    _context.People.Add(athy);
    //...
}
```
运行单元测试全部通过。

![Testperson](../image/testperson.png)

#### 添加Person控制器
